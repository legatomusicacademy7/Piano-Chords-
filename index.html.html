<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>LEGATO Music Academy</title>

<style>
body{
    margin:0;
    font-family: Arial, Helvetica, sans-serif;
    background:#111;
    color:white;
}

header{
    position:relative;
    padding:30px;
    border-bottom:2px solid #333;
}

.titulo-principal{
    text-align:center;
    font-size:32px;
    font-weight:bold;
}

.subtitulo{
    position:absolute;
    right:30px;
    top:30px;
    text-align:right;
    font-size:16px;
    color:#ccc;
}

.piano{
    display:flex;
    justify-content:center;
    position:relative;
    margin:20px 0;
}

.tecla{
    border:1px solid #444;
    display:inline-block;
    position:relative;
    text-align:center;
    vertical-align:bottom;
    user-select:none;
    cursor:pointer;
    font-weight:bold;
    font-size:12px;
}

.tecla.blanca{
    width:40px;
    height:200px;
    background:white;
    color:black;
    z-index:1;
}

.tecla.negra{
    width:30px;
    height:120px;
    background: linear-gradient(to bottom, #555, #222);
    color:white;
    margin-left:-15px;
    margin-right:-15px;
    z-index:2;
    border-radius:3px;
}

.tecla.activa{
    background:#ccc !important;
}

.tecla.acorde{
    background:#1E90FF !important;
}

.tecla.escala{
    background:#FF4500 !important;
}
</style>
</head>

<body>

<header>
    <div class="titulo-principal">
        Bienvenidos a LEGATO Music Academy
    </div>

    <div class="subtitulo">
        Diccionario de Acordes para Piano <br>
        <strong>by Freddy Lara</strong>
    </div>
</header>

<section class="panel-control" style="display:flex; justify-content:center; gap:30px; padding:30px;">

<div>
<label>NOTA</label>
<select id="nota">
<option>C</option>
<option>C#/Db</option>
<option>D</option>
<option>D#/Eb</option>
<option>E</option>
<option>F</option>
<option>F#/Gb</option>
<option>G</option>
<option>G#/Ab</option>
<option>A</option>
<option>A#/Bb</option>
<option>B</option>
</select>
</div>

<div>
<label>ACORDE</label>
<select id="acorde">
<option>Mayor</option>
<option>Menor</option>
<option>add9</option>
<option>Dominante 7</option>
<option>m7</option>
<option>maj7</option>
<option>sus2</option>
<option>sus4</option>
<option>dism</option>
<option>aumen</option>
<option>11</option>
<option>13</option>
<option>maj9</option>
<option>2</option>
<option>4</option>
<option>5</option>
<option>6</option>
<option>5b</option>
<option>5#</option>
</select>
</div>

<div>
<label>ESCALA</label>
<select id="escala">
<option>Esc. Mayor</option>
<option>Esc. Menor</option>
<option>Esc. Armónica</option>
<option>Esc. Armó Menor</option>
<option>Esc. Pentatónica</option>
<option>Esc. Pent Menor</option>
<option>Esc. Blues</option>
<option>Esc. Jazz</option>
</select>
</div>

<div>
<label>NOTAS DE LA ESCALA</label>
<div id="notasEscala" style="margin-top:5px; padding:10px 15px; min-width:220px; background:#222; border:1px solid #444; border-radius:6px; font-weight:bold;">-</div>
</div>

</section>

<div id="pianoSuperior" class="piano"></div>
<div id="pianoInferior" class="piano"></div>

<script>

// ===== BASE =====
const notasBase = ["C","C#","D","D#","E","F","F#","G","G#","A","A#","B"];
const notas = notasBase;

const pianoSuperior = document.getElementById("pianoSuperior");
const pianoInferior = document.getElementById("pianoInferior");

const octavasSup = [1,2,3];
const octavasInf = [4,5,6];

// ===== CREAR PIANOS =====
function crearPiano(piano, octavas){
    octavas.forEach(oct=>{
        notas.forEach(n=>{
            const tecla = document.createElement("div");
            tecla.classList.add("tecla");
            tecla.dataset.note = n + oct;
            tecla.textContent = n;

            if(n.includes("#")){
                tecla.classList.add("negra");
            }else{
                tecla.classList.add("blanca");
            }

            tecla.addEventListener("click", ()=>{
                tecla.classList.add("activa");
                setTimeout(()=>{tecla.classList.remove("activa");},300);
            });

            piano.appendChild(tecla);
        });
    });
}

crearPiano(pianoSuperior, octavasSup);
crearPiano(pianoInferior, octavasInf);

// ===== ESCALAS =====
const patronesEscalas = {
"esc. mayor":[2,2,1,2,2,2,1],
"esc. menor":[2,1,2,2,1,2,2],
"esc. armónica":[2,1,2,2,1,3,1],
"esc. armó menor":[2,1,2,2,1,3,1],
"esc. pentatónica":[2,2,3,2,3],
"esc. pent menor":[3,2,2,3,2],
"esc. blues":[3,2,1,1,3,2],
"esc. jazz":[2,1,2,2,3,1,2]
};

function generarEscala(){

    let nota = document.getElementById("nota").value;
    const escalaTipo = document.getElementById("escala").value.toLowerCase();

    if(nota.includes("/")){
        nota = nota.split("/")[0];
    }

    if(!patronesEscalas[escalaTipo]){
        document.getElementById("notasEscala").innerText = "-";
        iluminarEscala([]);
        return;
    }

    let indice = notasBase.indexOf(nota);
    const patron = patronesEscalas[escalaTipo];
    const escala = [nota];

    for(let paso of patron){
        indice = (indice + paso) % 12;
        escala.push(notasBase[indice]);
    }

    document.getElementById("notasEscala").innerText = escala.join(" - ");
    iluminarEscala(escala);
}

// ===== ACORDES =====
const patronesAcordes = {
"mayor":[0,4,7],
"menor":[0,3,7],
"add9":[0,4,7,2],
"dominante 7":[0,4,7,10],
"m7":[0,3,7,10],
"maj7":[0,4,7,11],
"sus2":[0,2,7],
"sus4":[0,5,7],
"dism":[0,3,6],
"aumen":[0,4,8],
"11":[0,4,7,10,14],
"13":[0,4,7,10,14,17],
"maj9":[0,4,7,11,14],
"2":[0,2,4],
"4":[0,5,7],
"5":[0,7],
"6":[0,4,7,9],
"5b":[0,6],
"5#":[0,8]
};

function actualizarAcorde(){

    let nota = document.getElementById("nota").value;
    const acordeTipo = document.getElementById("acorde").value.toLowerCase();

    if(nota.includes("/")){
        nota = nota.split("/")[0];
    }

    if(!patronesAcordes[acordeTipo]) return;

    const intervalo = patronesAcordes[acordeTipo];

    const notasAcorde = intervalo.map(i=>{
        let indice = (notasBase.indexOf(nota) + i) % 12;
        return notasBase[indice];
    });

    pianoSuperior.querySelectorAll(".tecla").forEach(tecla=>{
        tecla.classList.remove("acorde");
        const notaTecla = tecla.dataset.note.replace(/[0-9]/g,'');
        if(notasAcorde.includes(notaTecla)){
            tecla.classList.add("acorde");
        }
    });
}

// ===== ILUMINAR ESCALA =====
function iluminarEscala(escalaNotas){
    pianoInferior.querySelectorAll(".tecla").forEach(t=>{
        t.classList.remove("escala");
        const notaTecla = t.dataset.note.replace(/[0-9]/g,'');
        if(escalaNotas.includes(notaTecla)){
            t.classList.add("escala");
        }
    });
}

// ===== EVENTOS =====
document.getElementById("nota").addEventListener("change", ()=>{
    actualizarAcorde();
    generarEscala();
});
document.getElementById("acorde").addEventListener("change", actualizarAcorde);
document.getElementById("escala").addEventListener("change", generarEscala);

</script>

</body>
</html>
